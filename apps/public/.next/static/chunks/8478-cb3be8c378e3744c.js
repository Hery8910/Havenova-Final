(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8478],{8478:function(e,t,r){"use strict";r.d(t,{default:function(){return c}});var n=r(7830),a=r(3723),o=r(9401),l=r.n(o),i=r(573),s=r(6240),u=r(6685);function c(){let{user:e}=(0,u.a)(),{texts:t}=(0,s.Q)(),[r,o]=(0,a.useState)("light");return(0,a.useEffect)(()=>{(null==e?void 0:e.theme)?o(e.theme):o(localStorage.getItem("theme")||"light")},[e]),(0,n.jsxs)("main",{className:l().loadingContainer,children:[(0,n.jsx)(i.default,{src:"dark"===r?"/images/logos/logo-vertical-dark.webp":"/images/logos/logo-vertical-light.webp",alt:"Havenova Logo",width:500,height:500,className:l().logo}),(0,n.jsxs)("ul",{className:l().ul,children:[(0,n.jsx)("li",{className:l().dot}),(0,n.jsx)("li",{className:l().dot}),(0,n.jsx)("li",{className:l().dot}),(0,n.jsx)("li",{className:l().dot})]})]})}},7494:function(e,t,r){"use strict";r.d(t,{ClientProvider:function(){return i},m:function(){return s}});var n=r(7830),a=r(3723),o=r(36);let l=(0,a.createContext)(void 0);function i(e){let{children:t,initialClient:r}=e,[i,s]=(0,a.useState)(r),[u,c]=(0,a.useState)(!0),d="havenova.de";return(0,a.useEffect)(()=>{(async()=>{try{let{data:e}=await o.Z.get("/api/clients/by-domain/".concat(d));(null==e?void 0:e.client.branding)&&(null==e?void 0:e.client.typography)&&function(e,t){let r=document.documentElement;if(Object.entries({"--brand-primary":e.primaryColor,"--brand-secondary":e.secondaryColor,"--brand-accent":e.accentColor,"--bg-primary":e.backgroundMain,"--bg-secondary":e.backgroundSecondary,"--bg-accent":e.backgroundAccent,"--text-primary":e.textColorPrimary,"--text-secondary":e.textColorSecondary,"--bg-card":e.cardBackground,"--shadow-dark":e.shadowDark,"--color-success":e.colorSuccess,"--bg-success":e.bgSuccess,"--color-error":e.colorError,"--bg-error":e.bgError,"--color-warning":e.colorWarning,"--bg-warning":e.bgWarning,"--color-info":e.colorInfo,"--bg-info":e.bgInfo}).forEach(e=>{let[t,n]=e;n&&r.style.setProperty(t,n)}),t.isGoogleFont&&t.googleFontUrl){let e=document.querySelector("link[data-brand-font]");if(e)e.setAttribute("href",t.googleFontUrl);else{let e=document.createElement("link");e.rel="stylesheet",e.href=t.googleFontUrl,e.setAttribute("data-brand-font","true"),document.head.appendChild(e)}}}(e.client.branding,e.client.typography),s(e.client)}catch(e){console.error("Error loading client config:",e)}finally{c(!1)}})()},[d]),(0,n.jsx)(l.Provider,{value:{client:i,loading:u},children:t})}function s(){let e=(0,a.useContext)(l);if(!e)throw Error("useClient must be used within a ClientProvider");return e}},6240:function(e,t,r){"use strict";r.d(t,{Q:function(){return i},b:function(){return l}});var n=r(7830),a=r(3723);let o=(0,a.createContext)(void 0);function l(e){let{children:t,initialLanguage:r,initialTexts:l}=e,[i,s]=(0,a.useState)(r),[u,c]=(0,a.useState)(l);return(0,a.useEffect)(()=>{let e=localStorage.getItem("havenova_lang");e&&e!==i&&s(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("havenova_lang",i),document.cookie="lang=".concat(i,"; path=/;"),fetch("/i18n/".concat(i,".json")).then(e=>e.json()).then(e=>{c(e)}).catch(e=>{console.error("❌ I18nProvider: Error cargando textos",e)})},[i]),(0,a.useEffect)(()=>{let e=e=>{"havenova_lang"===e.key&&e.newValue&&s(e.newValue)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,n.jsx)(o.Provider,{value:{language:i,setLanguage:s,texts:u},children:t})}function i(){let e=(0,a.useContext)(o);if(!e)throw Error("useI18n must be used within I18nProvider");return e}},6685:function(e,t,r){"use strict";r.d(t,{DashboardProvider:function(){return f},a:function(){return v}});var n=r(7830),a=r(3723),o=r(7494),l=r(8511);let i="havenova_user",s="guest_avatar";function u(){return localStorage.getItem(s)||(localStorage.setItem(s,"/svg/user.svg"),"/svg/user.svg")}function c(e){localStorage.setItem(i,JSON.stringify(e))}let d=(0,a.createContext)(void 0),g={_id:"",clientId:"",name:"",email:"",password:"",address:"",profileImage:"",phone:"",isVerified:!1,role:"guest",language:"de",theme:"light",requests:[],createdAt:new Date,isLogged:!1},f=e=>{let{children:t}=e,{client:r}=(0,o.m)(),s=(null==r?void 0:r._id)||"",[f,v]=(0,a.useState)(null),[h,m]=(0,a.useState)(!0),p=a.useRef(null);(0,a.useEffect)(()=>{s&&b()},[s]),(0,a.useEffect)(()=>{f&&c(f)},[f]);let b=(0,a.useCallback)(async e=>{var t,r,n,a,o;m(!0);let d=function(){let e=localStorage.getItem(i);if(!e)return null;try{let t=JSON.parse(e);return(null==t?void 0:t.createdAt)&&(t.createdAt=new Date(t.createdAt)),"boolean"!=typeof t.isLogged&&(t.isLogged="guest"!==t.role),Array.isArray(t.requests)||(t.requests=[]),t}catch(e){return null}}();try{let e=await (0,l.PR)(s);if(e.data){let n=e.data,a=null!==(t=null==d?void 0:d.requests)&&void 0!==t?t:[],o=function(e,t){let r=new Map;return[...t,...e].forEach(e=>{r.set(e.id,e)}),Array.from(r.values())}(a,null!==(r=null==n?void 0:n.requests)&&void 0!==r?r:[]),l={...n,requests:o,isLogged:!0,clientId:n.clientId||s,profileImage:n.profileImage||u()};v(l),c(l)}}catch(l){let t={...g,clientId:s,profileImage:u()},r=d?{...t,...d,isLogged:!1,role:"guest"}:t;v(r),c(r),d&&d.isLogged&&"guest"!==d.role&&((null==l?void 0:null===(n=l.response)||void 0===n?void 0:n.status)===401||(null==l?void 0:null===(a=l.response)||void 0===a?void 0:a.status)===403)&&(e?e():null===(o=p.current)||void 0===o||o.call(p))}finally{m(!1)}},[s]),y=(0,a.useCallback)(e=>{p.current=e},[]),w=(0,a.useCallback)(async e=>{if(!f||"guest"===f.role||!f.isLogged){let t={...null!=f?f:g,language:e,clientId:s};v(t),c(t);return}try{let t={...(await (0,l.Nq)({clientId:s,language:e})).data,isLogged:!0};v(t),c(t)}catch(e){console.error("Failed to update user language:",e)}},[f,s]),_=(0,a.useCallback)(async e=>{if(!f||"guest"===f.role||!f.isLogged){let t={...null!=f?f:g,theme:e,clientId:s};v(t),c(t);return}try{let t={...(await (0,l.Nq)({clientId:s,theme:e})).data,isLogged:!0};v(t),c(t)}catch(e){console.error("Failed to update user theme:",e)}},[f,s]),C=(0,a.useCallback)(()=>{localStorage.removeItem(i);let e={...g,clientId:s,profileImage:u()};v(e),c(e)},[s]);return h?null:(0,n.jsx)(d.Provider,{value:{user:f,loading:h,setUser:v,refreshUser:b,logout:C,updateUserLanguage:w,updateUserTheme:_,registerSessionCallback:y},children:t})},v=()=>{let e=(0,a.useContext)(d);if(!e)throw Error("useUser must be used within a DashboardProvider");return e}},36:function(e,t,r){"use strict";var n=r(8764);let a="http://localhost:5000";if(!a)throw Error("❌ NEXT_PUBLIC_API_URL is not defined in .env.local");let o=n.Z.create({baseURL:a,withCredentials:!0});t.Z=o},8511:function(e,t,r){"use strict";r.d(t,{A8:function(){return c},Nq:function(){return l},PR:function(){return u},a$:function(){return a},c0:function(){return s},gF:function(){return i},pH:function(){return o}});var n=r(36);let a=async e=>(await n.Z.post("/api/users/register",e)).data,o=async e=>(await n.Z.post("/api/users/login",e)).data,l=async e=>(await n.Z.post("/api/users/update-user",e)).data,i=async e=>(await n.Z.post("/api/users/forgot-password",e)).data,s=async e=>(await n.Z.post("/api/users/reset-password",e)).data,u=async e=>(await n.Z.get("/api/users/profile?clientId=".concat(e))).data,c=async e=>(await n.Z.post("/api/users/resend-verification",{payload:e})).data},9401:function(e){e.exports={loadingContainer:"Loading_loadingContainer__Aihtg",ul:"Loading_ul__g1Sl4",dot:"Loading_dot__i3PXV",bounce:"Loading_bounce__bfesO",loadingText:"Loading_loadingText__SbJ5C",blink:"Loading_blink__xGxWE"}}}]);