(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9639],{4299:function(e,t,r){Promise.resolve().then(r.bind(r,8753))},8753:function(e,t,r){"use strict";r.r(t);var n=r(7830),a=r(3723),o=r(9672),s=r(1709),i=r.n(s);r(8511);var u=r(6685),l=r(7494),c=r(6240);t.default=()=>{var e;let{refreshUser:t}=(0,u.a)(),{client:r}=(0,l.m)(),{texts:s}=(0,c.Q)();(0,o.useRouter)(),s.popups,null==s||null===(e=s.pages)||void 0===e||e.user.login;let[d,g]=(0,a.useState)(null);return(0,n.jsx)("section",{className:i().section})}},9672:function(e,t,r){"use strict";var n=r(3142);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},7494:function(e,t,r){"use strict";r.d(t,{ClientProvider:function(){return i},m:function(){return u}});var n=r(7830),a=r(3723),o=r(36);let s=(0,a.createContext)(void 0);function i(e){let{children:t,initialClient:r}=e,[i,u]=(0,a.useState)(r),[l,c]=(0,a.useState)(!0),d="havenova.de";return(0,a.useEffect)(()=>{(async()=>{try{let{data:e}=await o.Z.get("/api/clients/by-domain/".concat(d));(null==e?void 0:e.client.branding)&&(null==e?void 0:e.client.typography)&&function(e,t){let r=document.documentElement;if(Object.entries({"--brand-primary":e.primaryColor,"--brand-secondary":e.secondaryColor,"--brand-accent":e.accentColor,"--bg-primary":e.backgroundMain,"--bg-secondary":e.backgroundSecondary,"--bg-accent":e.backgroundAccent,"--text-primary":e.textColorPrimary,"--text-secondary":e.textColorSecondary,"--bg-card":e.cardBackground,"--shadow-dark":e.shadowDark,"--color-success":e.colorSuccess,"--bg-success":e.bgSuccess,"--color-error":e.colorError,"--bg-error":e.bgError,"--color-warning":e.colorWarning,"--bg-warning":e.bgWarning,"--color-info":e.colorInfo,"--bg-info":e.bgInfo}).forEach(e=>{let[t,n]=e;n&&r.style.setProperty(t,n)}),t.isGoogleFont&&t.googleFontUrl){let e=document.querySelector("link[data-brand-font]");if(e)e.setAttribute("href",t.googleFontUrl);else{let e=document.createElement("link");e.rel="stylesheet",e.href=t.googleFontUrl,e.setAttribute("data-brand-font","true"),document.head.appendChild(e)}}}(e.client.branding,e.client.typography),u(e.client)}catch(e){console.error("Error loading client config:",e)}finally{c(!1)}})()},[d]),(0,n.jsx)(s.Provider,{value:{client:i,loading:l},children:t})}function u(){let e=(0,a.useContext)(s);if(!e)throw Error("useClient must be used within a ClientProvider");return e}},6240:function(e,t,r){"use strict";r.d(t,{Q:function(){return i},b:function(){return s}});var n=r(7830),a=r(3723);let o=(0,a.createContext)(void 0);function s(e){let{children:t,initialLanguage:r,initialTexts:s}=e,[i,u]=(0,a.useState)(r),[l,c]=(0,a.useState)(s);return(0,a.useEffect)(()=>{let e=localStorage.getItem("havenova_lang");e&&e!==i&&u(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("havenova_lang",i),document.cookie="lang=".concat(i,"; path=/;"),fetch("/i18n/".concat(i,".json")).then(e=>e.json()).then(e=>{c(e)}).catch(e=>{console.error("❌ I18nProvider: Error cargando textos",e)})},[i]),(0,a.useEffect)(()=>{let e=e=>{"havenova_lang"===e.key&&e.newValue&&u(e.newValue)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,n.jsx)(o.Provider,{value:{language:i,setLanguage:u,texts:l},children:t})}function i(){let e=(0,a.useContext)(o);if(!e)throw Error("useI18n must be used within I18nProvider");return e}},6685:function(e,t,r){"use strict";r.d(t,{DashboardProvider:function(){return f},a:function(){return v}});var n=r(7830),a=r(3723),o=r(7494),s=r(8511);let i="havenova_user",u="guest_avatar";function l(){return localStorage.getItem(u)||(localStorage.setItem(u,"/svg/user.svg"),"/svg/user.svg")}function c(e){localStorage.setItem(i,JSON.stringify(e))}let d=(0,a.createContext)(void 0),g={_id:"",clientId:"",name:"",email:"",password:"",address:"",profileImage:"",phone:"",isVerified:!1,role:"guest",language:"de",theme:"light",requests:[],createdAt:new Date,isLogged:!1},f=e=>{let{children:t}=e,{client:r}=(0,o.m)(),u=(null==r?void 0:r._id)||"",[f,v]=(0,a.useState)(null),[p,h]=(0,a.useState)(!0),m=a.useRef(null);(0,a.useEffect)(()=>{u&&y()},[u]),(0,a.useEffect)(()=>{f&&c(f)},[f]);let y=(0,a.useCallback)(async e=>{var t,r,n,a,o;h(!0);let d=function(){let e=localStorage.getItem(i);if(!e)return null;try{let t=JSON.parse(e);return(null==t?void 0:t.createdAt)&&(t.createdAt=new Date(t.createdAt)),"boolean"!=typeof t.isLogged&&(t.isLogged="guest"!==t.role),Array.isArray(t.requests)||(t.requests=[]),t}catch(e){return null}}();try{let e=await (0,s.PR)(u);if(e.data){let n=e.data,a=null!==(t=null==d?void 0:d.requests)&&void 0!==t?t:[],o=function(e,t){let r=new Map;return[...t,...e].forEach(e=>{r.set(e.id,e)}),Array.from(r.values())}(a,null!==(r=null==n?void 0:n.requests)&&void 0!==r?r:[]),s={...n,requests:o,isLogged:!0,clientId:n.clientId||u,profileImage:n.profileImage||l()};v(s),c(s)}}catch(s){let t={...g,clientId:u,profileImage:l()},r=d?{...t,...d,isLogged:!1,role:"guest"}:t;v(r),c(r),d&&d.isLogged&&"guest"!==d.role&&((null==s?void 0:null===(n=s.response)||void 0===n?void 0:n.status)===401||(null==s?void 0:null===(a=s.response)||void 0===a?void 0:a.status)===403)&&(e?e():null===(o=m.current)||void 0===o||o.call(m))}finally{h(!1)}},[u]),b=(0,a.useCallback)(e=>{m.current=e},[]),_=(0,a.useCallback)(async e=>{if(!f||"guest"===f.role||!f.isLogged){let t={...null!=f?f:g,language:e,clientId:u};v(t),c(t);return}try{let t={...(await (0,s.Nq)({clientId:u,language:e})).data,isLogged:!0};v(t),c(t)}catch(e){console.error("Failed to update user language:",e)}},[f,u]),w=(0,a.useCallback)(async e=>{if(!f||"guest"===f.role||!f.isLogged){let t={...null!=f?f:g,theme:e,clientId:u};v(t),c(t);return}try{let t={...(await (0,s.Nq)({clientId:u,theme:e})).data,isLogged:!0};v(t),c(t)}catch(e){console.error("Failed to update user theme:",e)}},[f,u]),C=(0,a.useCallback)(()=>{localStorage.removeItem(i);let e={...g,clientId:u,profileImage:l()};v(e),c(e)},[u]);return p?null:(0,n.jsx)(d.Provider,{value:{user:f,loading:p,setUser:v,refreshUser:y,logout:C,updateUserLanguage:_,updateUserTheme:w,registerSessionCallback:b},children:t})},v=()=>{let e=(0,a.useContext)(d);if(!e)throw Error("useUser must be used within a DashboardProvider");return e}},36:function(e,t,r){"use strict";var n=r(8764);let a="http://localhost:5000";if(!a)throw Error("❌ NEXT_PUBLIC_API_URL is not defined in .env.local");let o=n.Z.create({baseURL:a,withCredentials:!0});t.Z=o},8511:function(e,t,r){"use strict";r.d(t,{A8:function(){return c},Nq:function(){return s},PR:function(){return l},a$:function(){return a},c0:function(){return u},gF:function(){return i},pH:function(){return o}});var n=r(36);let a=async e=>(await n.Z.post("/api/users/register",e)).data,o=async e=>(await n.Z.post("/api/users/login",e)).data,s=async e=>(await n.Z.post("/api/users/update-user",e)).data,i=async e=>(await n.Z.post("/api/users/forgot-password",e)).data,u=async e=>(await n.Z.post("/api/users/reset-password",e)).data,l=async e=>(await n.Z.get("/api/users/profile?clientId=".concat(e))).data,c=async e=>(await n.Z.post("/api/users/resend-verification",{payload:e})).data},1709:function(e){e.exports={main:"page_main__kjEPm",section:"page_section__3957J",header:"page_header__z22cv",aside:"page_aside__M2J7i",aside_form:"page_aside_form__WC9yI",link:"page_link__rPNdJ",aside_main:"page_aside_main__bD_2t"}}},function(e){e.O(0,[9017,8764,2223,1040,1744],function(){return e(e.s=4299)}),_N_E=e.O()}]);