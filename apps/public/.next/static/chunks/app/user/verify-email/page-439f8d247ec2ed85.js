(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6930],{2294:function(e,t,r){Promise.resolve().then(r.bind(r,1909))},1909:function(e,t,r){"use strict";r.r(t);var n=r(7830),a=r(9672),o=r(3723),i=r(6685),s=r(7494),l=r(6240),u=r(8355),c=r.n(u);r(8511),t.default=()=>{var e;let{user:t,setUser:r}=(0,i.a)(),{client:u}=(0,s.m)(),[d,g]=(0,o.useState)(!1),f=(0,a.useRouter)(),{texts:v}=(0,l.Q)(),p=v.popups,h=v.message.verifyEmail,m=null==v?void 0:null===(e=v.pages)||void 0===e?void 0:e.user.verifyEmail,[y,b]=(0,o.useState)(null),[w,_]=(0,o.useState)({message:h.alreadySend,className:"success"});return((0,o.useEffect)(()=>{(async()=>{try{if(!(null==t?void 0:t.isVerified))return;let e=(null==p?void 0:p.USER_ALREADY_VERIFIED)||{};g(!1),b({type:"success",title:e.title||"Benutzer bereits best\xe4tigt",description:e.description||"Deine E-Mail war bereits best\xe4tigt. Du bist jetzt eingeloggt und kannst Havenova uneingeschr\xe4nkt verwenden."});let r="worker"===t.role?"/user/profile/edit":"/";setTimeout(()=>f.push(r),3e3)}catch(t){let e=(null==p?void 0:p.INTERNAL_ERROR)||{};b({type:"error",title:e.title||"Unerwarteter Fehler",description:e.description||"Es ist ein Fehler aufgetreten. Bitte versuchen Sie es sp\xe4ter noch einmal oder kontaktieren Sie den Support."})}})()},[f,r,null==t?void 0:t.isVerified,null==t?void 0:t.role,null==p?void 0:p.INTERNAL_ERROR,null==p?void 0:p.USER_ALREADY_VERIFIED]),m)?(0,n.jsx)("main",{className:c().main}):(0,n.jsx)("section",{className:c().section,children:(0,n.jsx)("div",{className:c().skeleton,style:{width:"100%",height:504,background:"#eee"}})})}},9672:function(e,t,r){"use strict";var n=r(3142);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},7494:function(e,t,r){"use strict";r.d(t,{ClientProvider:function(){return s},m:function(){return l}});var n=r(7830),a=r(3723),o=r(36);let i=(0,a.createContext)(void 0);function s(e){let{children:t,initialClient:r}=e,[s,l]=(0,a.useState)(r),[u,c]=(0,a.useState)(!0),d="havenova.de";return(0,a.useEffect)(()=>{(async()=>{try{let{data:e}=await o.Z.get("/api/clients/by-domain/".concat(d));(null==e?void 0:e.client.branding)&&(null==e?void 0:e.client.typography)&&function(e,t){let r=document.documentElement;if(Object.entries({"--brand-primary":e.primaryColor,"--brand-secondary":e.secondaryColor,"--brand-accent":e.accentColor,"--bg-primary":e.backgroundMain,"--bg-secondary":e.backgroundSecondary,"--bg-accent":e.backgroundAccent,"--text-primary":e.textColorPrimary,"--text-secondary":e.textColorSecondary,"--bg-card":e.cardBackground,"--shadow-dark":e.shadowDark,"--color-success":e.colorSuccess,"--bg-success":e.bgSuccess,"--color-error":e.colorError,"--bg-error":e.bgError,"--color-warning":e.colorWarning,"--bg-warning":e.bgWarning,"--color-info":e.colorInfo,"--bg-info":e.bgInfo}).forEach(e=>{let[t,n]=e;n&&r.style.setProperty(t,n)}),t.isGoogleFont&&t.googleFontUrl){let e=document.querySelector("link[data-brand-font]");if(e)e.setAttribute("href",t.googleFontUrl);else{let e=document.createElement("link");e.rel="stylesheet",e.href=t.googleFontUrl,e.setAttribute("data-brand-font","true"),document.head.appendChild(e)}}}(e.client.branding,e.client.typography),l(e.client)}catch(e){console.error("Error loading client config:",e)}finally{c(!1)}})()},[d]),(0,n.jsx)(i.Provider,{value:{client:s,loading:u},children:t})}function l(){let e=(0,a.useContext)(i);if(!e)throw Error("useClient must be used within a ClientProvider");return e}},6240:function(e,t,r){"use strict";r.d(t,{Q:function(){return s},b:function(){return i}});var n=r(7830),a=r(3723);let o=(0,a.createContext)(void 0);function i(e){let{children:t,initialLanguage:r,initialTexts:i}=e,[s,l]=(0,a.useState)(r),[u,c]=(0,a.useState)(i);return(0,a.useEffect)(()=>{let e=localStorage.getItem("havenova_lang");e&&e!==s&&l(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("havenova_lang",s),document.cookie="lang=".concat(s,"; path=/;"),fetch("/i18n/".concat(s,".json")).then(e=>e.json()).then(e=>{c(e)}).catch(e=>{console.error("❌ I18nProvider: Error cargando textos",e)})},[s]),(0,a.useEffect)(()=>{let e=e=>{"havenova_lang"===e.key&&e.newValue&&l(e.newValue)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,n.jsx)(o.Provider,{value:{language:s,setLanguage:l,texts:u},children:t})}function s(){let e=(0,a.useContext)(o);if(!e)throw Error("useI18n must be used within I18nProvider");return e}},6685:function(e,t,r){"use strict";r.d(t,{DashboardProvider:function(){return f},a:function(){return v}});var n=r(7830),a=r(3723),o=r(7494),i=r(8511);let s="havenova_user",l="guest_avatar";function u(){return localStorage.getItem(l)||(localStorage.setItem(l,"/svg/user.svg"),"/svg/user.svg")}function c(e){localStorage.setItem(s,JSON.stringify(e))}let d=(0,a.createContext)(void 0),g={_id:"",clientId:"",name:"",email:"",password:"",address:"",profileImage:"",phone:"",isVerified:!1,role:"guest",language:"de",theme:"light",requests:[],createdAt:new Date,isLogged:!1},f=e=>{let{children:t}=e,{client:r}=(0,o.m)(),l=(null==r?void 0:r._id)||"",[f,v]=(0,a.useState)(null),[p,h]=(0,a.useState)(!0),m=a.useRef(null);(0,a.useEffect)(()=>{l&&y()},[l]),(0,a.useEffect)(()=>{f&&c(f)},[f]);let y=(0,a.useCallback)(async e=>{var t,r,n,a,o;h(!0);let d=function(){let e=localStorage.getItem(s);if(!e)return null;try{let t=JSON.parse(e);return(null==t?void 0:t.createdAt)&&(t.createdAt=new Date(t.createdAt)),"boolean"!=typeof t.isLogged&&(t.isLogged="guest"!==t.role),Array.isArray(t.requests)||(t.requests=[]),t}catch(e){return null}}();try{let e=await (0,i.PR)(l);if(e.data){let n=e.data,a=null!==(t=null==d?void 0:d.requests)&&void 0!==t?t:[],o=function(e,t){let r=new Map;return[...t,...e].forEach(e=>{r.set(e.id,e)}),Array.from(r.values())}(a,null!==(r=null==n?void 0:n.requests)&&void 0!==r?r:[]),i={...n,requests:o,isLogged:!0,clientId:n.clientId||l,profileImage:n.profileImage||u()};v(i),c(i)}}catch(i){let t={...g,clientId:l,profileImage:u()},r=d?{...t,...d,isLogged:!1,role:"guest"}:t;v(r),c(r),d&&d.isLogged&&"guest"!==d.role&&((null==i?void 0:null===(n=i.response)||void 0===n?void 0:n.status)===401||(null==i?void 0:null===(a=i.response)||void 0===a?void 0:a.status)===403)&&(e?e():null===(o=m.current)||void 0===o||o.call(m))}finally{h(!1)}},[l]),b=(0,a.useCallback)(e=>{m.current=e},[]),w=(0,a.useCallback)(async e=>{if(!f||"guest"===f.role||!f.isLogged){let t={...null!=f?f:g,language:e,clientId:l};v(t),c(t);return}try{let t={...(await (0,i.Nq)({clientId:l,language:e})).data,isLogged:!0};v(t),c(t)}catch(e){console.error("Failed to update user language:",e)}},[f,l]),_=(0,a.useCallback)(async e=>{if(!f||"guest"===f.role||!f.isLogged){let t={...null!=f?f:g,theme:e,clientId:l};v(t),c(t);return}try{let t={...(await (0,i.Nq)({clientId:l,theme:e})).data,isLogged:!0};v(t),c(t)}catch(e){console.error("Failed to update user theme:",e)}},[f,l]),E=(0,a.useCallback)(()=>{localStorage.removeItem(s);let e={...g,clientId:l,profileImage:u()};v(e),c(e)},[l]);return p?null:(0,n.jsx)(d.Provider,{value:{user:f,loading:p,setUser:v,refreshUser:y,logout:E,updateUserLanguage:w,updateUserTheme:_,registerSessionCallback:b},children:t})},v=()=>{let e=(0,a.useContext)(d);if(!e)throw Error("useUser must be used within a DashboardProvider");return e}},36:function(e,t,r){"use strict";var n=r(8764);let a="http://localhost:5000";if(!a)throw Error("❌ NEXT_PUBLIC_API_URL is not defined in .env.local");let o=n.Z.create({baseURL:a,withCredentials:!0});t.Z=o},8511:function(e,t,r){"use strict";r.d(t,{A8:function(){return c},Nq:function(){return i},PR:function(){return u},a$:function(){return a},c0:function(){return l},gF:function(){return s},pH:function(){return o}});var n=r(36);let a=async e=>(await n.Z.post("/api/users/register",e)).data,o=async e=>(await n.Z.post("/api/users/login",e)).data,i=async e=>(await n.Z.post("/api/users/update-user",e)).data,s=async e=>(await n.Z.post("/api/users/forgot-password",e)).data,l=async e=>(await n.Z.post("/api/users/reset-password",e)).data,u=async e=>(await n.Z.get("/api/users/profile?clientId=".concat(e))).data,c=async e=>(await n.Z.post("/api/users/resend-verification",{payload:e})).data},8355:function(e){e.exports={main:"page_main__6xQOv",section:"page_section__FFInf",header:"page_header__weqtU",form:"page_form__uw5T5",article:"page_article__m08Eo",link:"page_link__gliHo",input:"page_input__upmwV"}}},function(e){e.O(0,[7850,8764,2223,1040,1744],function(){return e(e.s=2294)}),_N_E=e.O()}]);